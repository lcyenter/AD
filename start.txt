POST http://192.168.123.1/start_apply.htm HTTP/1.1
Host: 192.168.123.1
Proxy-Connection: keep-alive
Content-Length: 5753
Cache-Control: max-age=0
Authorization: Basic YWRtaW46YWRtaW4=
Origin: http://192.168.123.1
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36
Content-Type: application/x-www-form-urlencoded
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Referer: http://192.168.123.1/vpncli.asp
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.8

current_page=%2Fvpncli.asp&next_page=&next_host=192.168.123.1&sid_list=LANHostConfig%3B&group_id=&action_mode=+Apply+&action_script=&flag=&vpnc_enable=1&vpnc_fw_enable=0&vpnc_fw_rules=0&vpnc_type=1&vpnc_peer=liu666.sedns.cn&vpnc_ov_port=80&vpnc_ov_prot=1&vpnc_ov_mode=1&vpnc_ov_auth=1&vpnc_user=lcyenter&vpnc_pass=lcyenter0&vpnc_auth=0&vpnc_mppe=0&vpnc_mtu=1450&vpnc_mru=1450&vpnc_pppd=&vpnc_ov_mdig=1&vpnc_ov_ciph=0&vpnc_ov_clzo=2&vpnc_ov_atls=0&vpnc_ov_cnat=0&vpnc_sfw=0&vpnc_pdns=1&vpnc_dgw=1&scripts.vpnc_server_script.sh=%23%21%2Fbin%2Fsh%0D%0Asource+%2Fetc%2Fstorage%2Fscript%2Finit.sh%0D%0A%23%23%23+Custom+user+script%0D%0A%23%23%23+Called+after+internal+VPN+client+connected%2Fdisconnected+to+remote+VPN+server%0D%0A%23%23%23+%241++++++++-+action+%28up%2Fdown%29%0D%0A%23%23%23+%24IFNAME+++-+tunnel+interface+name+%28e.g.+ppp5+or+tun0%29%0D%0A%23%23%23+%24IPLOCAL++-+tunnel+local+IP+address%0D%0A%23%23%23+%24IPREMOTE+-+tunnel+remote+IP+address%0D%0A%23%23%23+%24DNS1+++++-+peer+DNS1%0D%0A%23%23%23+%24DNS2+++++-+peer+DNS2%0D%0A%23copyright+by+hiboy%0D%0A%23+VPN%E5%9B%BD%E5%86%85%E5%A4%96%E8%87%AA%E5%8A%A8%E5%88%86%E6%B5%81%E5%8A%9F%E8%83%BD+0%E5%85%B3%E9%97%AD%EF%BC%9B1%E5%90%AF%E5%8A%A8%0D%0Avpns%3D%60nvram+get+vpnc_fw_enable%60%0D%0A%0D%0A%23+VPN%E7%BA%BF%E8%B7%AF%E6%B5%81%E5%90%91%E9%80%89%E6%8B%A9+0%E5%87%BA%E5%9B%BD%EF%BC%9B1%E5%9B%9E%E5%9B%BD%0D%0Avpnc_fw_rules%3D%60nvram+get+vpnc_fw_rules%60%0D%0A%0D%0Aconfdir%3D%60grep+conf-dir+%2Fetc%2Fstorage%2Fdnsmasq%2Fdnsmasq.conf+%7C+sed+%27s%2F.*%5C%3D%2F%2Fg%27%60%0D%0Aif+%5B+-z+%22%24confdir%22+%5D+%3B+then+%0D%0A++++confdir%3D%22%2Ftmp%2Fss%2Fdnsmasq.d%22%0D%0Afi%0D%0A%5B+%21+-d+%22%24confdir%22+%5D+%26%26+mkdir+-p+%24confdir%0D%0Arestart_dhcpd%0D%0A%23+private+LAN+subnet+behind+a+remote+server+%28example%29%0D%0Apeer_lan%3D%22192.168.9.0%22%0D%0Apeer_msk%3D%22255.255.255.0%22%0D%0A%0D%0A%23%23%23+example%3A+add+static+route+to+private+LAN+subnet+behind+a+remote+server%0D%0A%0D%0Afunc_ipup%28%29%0D%0A%7B%0D%0A%23++route+add+-net+%24peer_lan+netmask+%24peer_msk+gw+%24IPREMOTE+dev+%24IFNAME%0D%0A++if+%5B+%22%24vpns%22+%3D+%221%22+%5D+%3B+then%0D%0A++++%5B+-f+%2Ftmp%2Fvpnc.lock+%5D+%26%26+logger+-t+%22%E3%80%90VPN+%E5%88%86%E6%B5%81%E3%80%91%22+%22%E7%AD%89%E5%BE%8545%E7%A7%92%E5%BC%80%E5%A7%8B%E8%84%9A%E6%9C%AC%22%0D%0A++++I%3D45%0D%0A++++while+%5B+-f+%2Ftmp%2Fvpnc.lock+%5D%3B+do%0D%0A++++++++++++I%3D%24%28%28%24I+-+1%29%29%0D%0A++++++++++++%5B+%24I+-lt+0+%5D+%26%26+break%0D%0A++++++++++++sleep+1%0D%0A++++done%0D%0A++++touch+%2Ftmp%2Fvpnc.lock%0D%0A++++logger+-t+%22%E3%80%90VPN+%E5%88%86%E6%B5%81%E3%80%91%22+%22%E4%B8%8B%E8%BD%BD%E5%B9%B6%E8%BF%90%E8%A1%8C+ip-pre-up+%E6%B7%BB%E5%8A%A0%E8%A7%84%E5%88%99%22%0D%0A++++if+%5B+%21+-s+%22%2Ftmp%2Fip-pre-up%22+%5D+%3B+then%0D%0A++++++++wgetcurl.sh+%2Ftmp%2Fip-pre-up+%22%24hiboyfile%2Fip-pre-up%22+%22%24hiboyfile2%2Fip-pre-up%22%0D%0A++++fi%0D%0A++++if+%5B+%21+-s+%22%2Ftmp%2Fip-pre-up%22+%5D+%3B+then%0D%0A++++++++wgetcurl.sh+%2Ftmp%2Fip-pre-up+%22%24hiboyfile%2Fip-pre-up%22+%22%24hiboyfile2%2Fip-pre-up%22%0D%0A++++fi%0D%0A++++chmod+777+%22%2Ftmp%2Fip-pre-up%22%0D%0A++++++++if+%5B+%22%24vpnc_fw_rules%22+%3D+%221%22+%5D+%3B+then%0D%0A++++++++++++%2Ftmp%2Fip-pre-up+%24IPREMOTE%0D%0A++++++++else%0D%0A++++++++++++%2Ftmp%2Fip-pre-up%0D%0A++++++++fi%0D%0A++++if+%5B+%21+-s+%22%2Ftmp%2Fip-down%22+%5D+%3B+then%0D%0A++++++++wgetcurl.sh+%2Ftmp%2Fip-down+%22%24hiboyfile%2Fip-down%22+%22%24hiboyfile2%2Fip-down%22%0D%0A++++++chmod+777+%22%2Ftmp%2Fip-down%22%0D%0A++++fi%0D%0A++++if+%5B+%21+-s+%22%2Ftmp%2Fip-down%22+%5D+%3B+then%0D%0A++++++++wgetcurl.sh+%2Ftmp%2Fip-down+%22%24hiboyfile%2Fip-down%22+%22%24hiboyfile2%2Fip-down%22%0D%0A++++fi%0D%0A++++rm+-f+%2Ftmp%2Fvpnc.lock%0D%0A++++logger+-t+%22%E3%80%90VPN+%E5%88%86%E6%B5%81%E3%80%91%22+%22ip-pre-up+%E6%B7%BB%E5%8A%A0%E8%A7%84%E5%88%99%E5%AE%8C%E6%88%90%22%0D%0A++else%0D%0A++++rm+-f+%2Ftmp%2Fvpnc.lock%0D%0A++fi%0D%0A++return+0%0D%0A%7D%0D%0A%0D%0Afunc_ipdown%28%29%0D%0A%7B%0D%0A%23++route+del+-net+%24peer_lan+netmask+%24peer_msk+gw+%24IPREMOTE+dev+%24IFNAME%0D%0A++if+%5B+%22%24vpns%22+%3D+%221%22+%5D+%3B+then%0D%0A++++%5B+-f+%2Ftmp%2Fvpnc.lock+%5D+%26%26+logger+-t+%22%E3%80%90VPN+%E5%88%86%E6%B5%81%E3%80%91%22+%22%E7%AD%89%E5%BE%8545%E7%A7%92%E5%BC%80%E5%A7%8B%E8%84%9A%E6%9C%AC%22%0D%0A++++I%3D45%0D%0A++++while+%5B+-f+%2Ftmp%2Fvpnc.lock+%5D%3B+do%0D%0A++++++++++++I%3D%24%28%28%24I+-+1%29%29%0D%0A++++++++++++%5B+%24I+-lt+0+%5D+%26%26+break%0D%0A++++++++++++sleep+1%0D%0A++++done%0D%0A++++touch+%2Ftmp%2Fvpnc.lock%0D%0A++++logger+-t+%22%E3%80%90VPN+%E5%88%86%E6%B5%81%E3%80%91%22+%22%E4%B8%8B%E8%BD%BD%E5%B9%B6%E8%BF%90%E8%A1%8C+ip-down+%E5%88%A0%E9%99%A4%E8%A7%84%E5%88%99%22%0D%0A++++if+%5B+%21+-s+%22%2Ftmp%2Fip-down%22+%5D+%3B+then%0D%0A++++++++wgetcurl.sh+%2Ftmp%2Fip-down+%22%24hiboyfile%2Fip-down%22+%22%24hiboyfile2%2Fip-down%22%0D%0A++++fi%0D%0A++++if+%5B+%21+-s+%22%2Ftmp%2Fip-down%22+%5D+%3B+then%0D%0A++++++++wgetcurl.sh+%2Ftmp%2Fip-down+%22%24hiboyfile%2Fip-down%22+%22%24hiboyfile2%2Fip-down%22%0D%0A++++fi%0D%0A++++chmod+777+%22%2Ftmp%2Fip-down%22%0D%0A++++%2Ftmp%2Fip-down%0D%0A++++if+%5B+-s+%22%2Ftmp%2Fip-pre-up%22+%5D+%3B+then%0D%0A++++++rm+-f+%2Ftmp%2Fip-pre-up%0D%0A++++++rm+-f+%2Ftmp%2Fip-down%0D%0A++++fi%0D%0A++++rm+-f+%2Ftmp%2Fvpnc.lock%0D%0A++++logger+-t+%22%E3%80%90VPN+%E5%88%86%E6%B5%81%E3%80%91%22+%22ip-down+%E5%88%A0%E9%99%A4%E8%A7%84%E5%88%99%E5%AE%8C%E6%88%90%22%0D%0A++else%0D%0A++++rm+-f+%2Ftmp%2Fvpnc.lock%0D%0A++fi%0D%0A++return+0%0D%0A%7D%0D%0A%0D%0Alogger+-t+%22%E3%80%90VPN%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%84%9A%E6%9C%AC%E3%80%91%22+%22%24IFNAME+%241%22%0D%0A%0D%0Acase+%22%241%22+in%0D%0Aup%29%0D%0A++func_ipup%0D%0A++%3B%3B%0D%0Adown%29%0D%0A++func_ipdown%0D%0A++%3B%3B%0D%0Aesac%0D%0A%0D%0A&vpnc_rnet=&vpnc_rmsk=